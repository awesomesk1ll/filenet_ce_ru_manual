# Версии

В CE реализовано версионирование документов. Основные идеи:

* каждый документ имеет номер старшей (major) и младшей (minor) версий. "Общая" версия состоит из старшей и младшей (далее пишем через точку: major.minor)
* только что созданный документ имеет версию 0.1
* старшая версия обычно инкрементируется при "выпуске" (release) документа. Обычно под выпуском подразумевается, что документ становится доступен широкой публике
* младшая версия обычно инкрементируется при изменении документа между выпусками, что может означать некие промежуточные изменения при подготовке к очередному выпуску
* каждая версия документа - это самостоятельный документ со своими метаданными, правами доступа, содержимым и т.д.
* *набором версий (version series)* называется список документов, составляющих одну "цепочку изменений". Самое последнее звено в этой цепочке называется *текущей версией (current version)*

## Состояние версии

Каждая версия находится в одном из 4-х состояний:

* **Выпущенная (released)**. Это последний выпуск документа, т.е. последняя версия вида X.0
* **Промежуточная (in-process)**. Это последняя версия вида X.Y, где Y не равен 0
* **Зарезервированная (reserved)**. Специальная версия, которая создаётся в резульате чекаута
* **Замещённая (superseded)**. Любая версия, заменённая другой, более новой

В наборе версий может быть только одна выпущенная и только одна промежуточная версия.

Важно: "текущая" не является состоянием. Текущей версией может быть выпущенная или промежуточная версии.

## Чекаут, чекин

Основной способ создания новой версии - процедура check out/check in 

**Check out** - создание зарезервированной версии из текущей

* можно делать чекаут только текущей (выпущенной или промежуточной) версиии
* нельзя сделать чекаут одной и той же версии дважды
* в результате создаётся новая зарезервированная версия с номером младшей версии, увеличенным на 1

**Check in** - создание новой текущей версии из зарезервированной

* зарезервированная версия становится текущей версией
* та версия, которая была текущей, становится замещённой
* существует два типа чекина: младший и старший. При младшем типе зарезервированная версия становится промежуточной, номер не меняется. При старшем типе номер меняется с X.Y до (X+1).0, зарезервированная версия становится выпущенной

Типичный порядок действи:

1. Чекаут текущей версии
2. Работа с зарезервированной версией
3. Чекин зарезервированной версии

## Пример

Действие | Версия 1 | Версия 2 | Версия 3
------------ | ------------- | ------------- | -------------
Создание документа, внесение изменений, чекин (minor) | 0.1 **Промежуточная** | |
Чекаут, внесение изменений | 0.1 **Промежуточная** | 0.2 **Зарезервированная** | 
Чекин (minor)| 0.1 **Замещённая** |  0.2 **Промежуточная** |
Чекаут, внесение изменений| 0.1 **Замещённая** | 0.2 **Промежуточная**|0.3 **Зарезервированная**
Чекин (major)| 0.1 **Замещённая** | 0.2 **Замещённая**| 1.0 **Выпущенная**
